generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum Gender {
  Male
  Female
  Other
}

enum MaritalStatus {
  Single
  Married
  Divorced
  Widowed
  Separated
}

enum Role {
  ADMIN
  BOARD_OWNER
  CEO_MANAGING_DIRECTOR
  CTO
  COO
  DEPARTMENT_HEAD
  ENGINEERING_HEAD
  DESIGN_HEAD
  PROJECT_MANAGEMENT_HEAD
  PRODUCT_HEAD
  HR_HEAD
  FINANCE_HEAD
  SALES_MARKETING_HEAD
  SUPPORT_OPERATIONS_HEAD
  TECH_LEAD
  QA_LEAD
  DEVOPS_ENGINEER
  PRODUCT_MANAGER
  PROJECT_MANAGER
  SENIOR_DEVELOPER
  SCRUM_MASTER
  HR_MANAGER
  SALES_MANAGER
  MID_LEVEL_DEVELOPER
  UI_UX_DESIGNER
  ACCOUNTANT
  BUSINESS_DEVELOPMENT_EXECUTIVE
  QA_ENGINEER
  PAYROLL_OFFICER
  JUNIOR_DEVELOPER
  GRAPHIC_DESIGNER
  HR_EXECUTIVE
  MARKETING_EXECUTIVE
  OFFICE_ADMIN
  IT_SUPPORT
  INTERN
  CLIENT
}

model Address {
  id                        String    @id @default(uuid())
  division                  String
  district                  String
  upazilaOrThana            String
  postOffice                String
  postCode                  String
  block                     String
  houseNoOrVillage          String
  roadNo                    String?   @default("n/a")
  createdAt                 DateTime  @default(now())
  employeePresentAddress    Employee? @relation("employeePresentAddress")
  employeePermanenttAddress Employee? @relation("employeePermanentAddress")
}

model ContactInformation {
  id                        String    @id @default(uuid())
  fullName                  String    @default("n/a")
  dateOfBirth               DateTime  @default(now())
  gender                    String    @default("n/a")
  occupation                String    @default("n/a")
  nid                       String    @default("n/a")
  mobileNumber              String    @default("n/a")
  email                     String    @default("n/a")
  createdAt                 DateTime  @default(now())
  employeeSpouseInformation Employee? @relation("spouseInformation")
  employeeEmergencyContact  Employee? @relation("emergencyContact")
}

model AdditionalInformation {
  id               String         @id @default(uuid())
  fatherName       String?        @default("n/a")
  motherName       String?        @default("n/a")
  nationalId       String?        @default("n/a")
  placeOfBirth     String?        @default("n/a")
  maritalStatus    MaritalStatus? @default(Single)
  eTIN             String?        @default("n/a")
  program          String?        @default("n/a")
  unit             String?        @default("n/a")
  prlDate          DateTime?      @default(now())
  dateofRegularity DateTime?      @default(now())
  createdAt        DateTime       @default(now())
  employee         Employee?
}

model PersonalInformation {
  id                 String    @id @default(uuid())
  fullName           String
  imageUrl           String
  role               Role
  score              Int
  officeEmail        String    @unique
  personalEmail      String    @unique
  personalNumber     String
  officeNumber       String
  employeeType       String
  employeeStatus     String
  nationality        String
  disability         Boolean
  gender             Gender
  religion           String
  joiningDesignation String
  currentDesignation String
  dateOfBirth        DateTime  @default(now())
  dateOfConfirmation DateTime  @default(now())
  createdAt          DateTime  @default(now())
  employee           Employee?
}

model BankInformation {
  id            String     @id @default(uuid())
  bankName      String
  branchName    String
  accountNumber String
  walletType    String     @default("N/A")
  walletNumber  String     @default("N/A")
  createdAt     DateTime   @default(now())
  employees     Employee[]
}

enum AttendanceStatus {
  In
  Out
}

model Attendance {
  id               String           @id @default(uuid())
  checkIn          DateTime         @default(now())
  checkOut         DateTime?
  preferableInTime DateTime
  status           AttendanceStatus
  createdAt        DateTime         @default(now())
  employee         Employee?        @relation(fields: [employeeId], references: [id])
  employeeId       String?
}

model Leave {
  id        String    @id @default(uuid())
  casual    Int       @default(14)
  sick      Int       @default(10)
  earned    Int       @default(10)
  createdAt DateTime  @default(now())
  employee  Employee?
}

model Employee {
  id                     String                @id @default(uuid())
  createdAt              DateTime              @default(now())
  // Personal Information Relation
  personalInformationId  String                @unique
  personalInformation    PersonalInformation   @relation(fields: [personalInformationId], references: [id], onDelete: Cascade)
  // Bank Information Relation
  bankInformationId      String
  bankInformation        BankInformation       @relation(fields: [bankInformationId], references: [id], onDelete: Cascade)
  // Addtional Informatio Relation
  addtionalInformationId String                @unique
  additionalInformation  AdditionalInformation @relation(fields: [addtionalInformationId], references: [id], onDelete: Cascade)
  // Address Relation
  presentAddressId       String                @unique
  presentAddress         Address               @relation(name: "employeePresentAddress", fields: [presentAddressId], references: [id], onDelete: Cascade)
  permanentAddressId     String                @unique
  permanentAddress       Address               @relation(name: "employeePermanentAddress", fields: [permanentAddressId], references: [id], onDelete: Cascade)
  // Spouse Information Relation
  spouseInformation      ContactInformation?   @relation(name: "spouseInformation", fields: [spouseInformationId], references: [id], onDelete: Cascade)
  spouseInformationId    String?               @unique
  // Emergency Contact Relation
  emergencyContact       ContactInformation    @relation(name: "emergencyContact", fields: [emergencyContactId], references: [id], onDelete: Cascade)
  emergencyContactId     String                @unique
  // Attendance
  attendance             Attendance[]
  // Leave Relation
  remainingLeave         Leave                 @relation(fields: [remainingLeaveId], references: [id], onDelete: Cascade)
  remainingLeaveId       String                @unique
  // User Relation
  user                   User                  @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId                 String                @unique
  // Leave Management Relation
  approver               LeaveManagement?      @relation("approverEmployee")
  leavesTaken            LeaveManagement[]     @relation("employeeLeavesTaken")
}

enum LeaveStatus {
  pending
  accepted
  rejected
}

model LeaveManagement {
  id                     String      @id @default(uuid())
  leaveType              String
  leaveFrom              DateTime
  leaveTO                DateTime
  purposeOfLeave         String
  addressDuringLeave     String
  emergencyContactNumber String
  approved               LeaveStatus @default(pending)
  approverId             String      @unique
  approvedBy             Employee    @relation(name: "approverEmployee", fields: [approverId], references: [id])
  employee               Employee    @relation(name: "employeeLeavesTaken", fields: [employeeId], references: [id])
  employeeId             String
}

model User {
  id            String    @id
  name          String
  email         String
  emailVerified Boolean   @default(false)
  image         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  role          String    @default("employee")
  sessions      Session[]
  accounts      Account[]
  employee      Employee?
  score         Int       @default(60)

  @@unique([email])
  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime
  token     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([token])
  @@index([userId])
  @@map("session")
}

model Account {
  id                    String    @id
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt

  @@index([userId])
  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@index([identifier])
  @@map("verification")
}
